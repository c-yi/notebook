(window.webpackJsonp=window.webpackJsonp||[]).push([[49],{417:function(s,e,a){"use strict";a.r(e);var n=a(23),t=Object(n.a)({},(function(){var s=this,e=s.$createElement,a=s._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"视图"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#视图"}},[s._v("#")]),s._v(" 视图")]),s._v(" "),a("h2",{attrs:{id:"视图创建"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#视图创建"}},[s._v("#")]),s._v(" 视图创建")]),s._v(" "),a("p",[s._v("视图: view,一种由select指令组成的 虚拟表")]),s._v(" "),a("ul",[a("li",[s._v("视图是虚拟表,可以使用表管理(结构管理)\n"),a("ul",[a("li",[s._v("为视图提供数据的表叫做基表")])])])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#创建视图\ncreate view 视图名字 as select指令;\n\n#访问视图:一般都是查询\n\nselect *|字段名 from 视图名字;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("ul",[a("li",[s._v("视图有结构,但不存储数据\n"),a("ul",[a("li",[s._v("结构: select选择的字段")]),s._v(" "),a("li",[s._v("数据:访问视图时执行的 select指令")])])])]),s._v(" "),a("blockquote",[a("p",[s._v("示例")])]),s._v(" "),a("p",[s._v("1、需要对外提供一个学生详情的数据,经常使用:可以利用视图实现")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#对外提供数据,要保护数据本身的安全\n#需要长期使用\n#创建视图\ncreate view v_student_info as select from t_45 left join t_46 using (c_id);\n#使用视图:像表一样使用\nselect from v_student_info:\n\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("p",[s._v("2、有些复杂的SQL又是经常用到的,如多张表的连表操作,可以利用视图实现")]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("#院系表\ncreate table t_53(\nid int primary key auto_increment,\nname varchar(50) not null\n)charset utf8;\ninsert into t_53 values(nu11,'语言系'),(nu11,'考古系')\n#专业表\ncreate table t54(\nid int primary key auto_increment,\nname varchar(50) not null,\ns_id int not nul comment '学院id'\n)charset utf8;\ninsert into t_54 values (null, English,1),(null, chinese, 1);\n    \n#学生表\ncreate table t_55(\nid int primary key auto_increment,\nname varchar(50) not null,\ns_id int not null comment '专业Id'\n)charset utf8;\ninsert into t_55 values(null, 'Lilei', 2), (null, 'Mark', 2),(null, 'Tony', 1);;\n\n#获取所有学生的明细信息\nselect stu.* sub.name as sub_name, sub.s_id as sch_id, sch.name as sch_name \nfrom t_55 as stu \nleft join t_54 as sub on stu.s_id = sub.id \nleft join t_53 as sch on sub.s_id= sch.id;\n\n#以视图保存这类复杂指令,后续可以直接访问视图\ncreate view v_student_detail \nas select stu.*, sub.name as sub_name sub.s_id as sch_id, sch.name as sch_name \nfrom t_55 as stu \nleft join t_54 as sub on stu.s_id= sub.id \nleft join t_53 as sch on sub.s_id= sch.id;\n\n# 以视图访问\nselect from v_student_ detail\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br")])]),a("h2",{attrs:{id:"视图管理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#视图管理"}},[s._v("#")]),s._v(" 视图管理")]),s._v(" "),a("ol",[a("li",[s._v("查看全部视图和视图明细")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("show tables;#查看全部表,包括视图\ndesc v_student_detail;#查看视图结构\nshow create view v_student_detail;#查看视图创建明细\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("修改视图:重置视图数据逻辑")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("# 修改\nalter view 视图名 as select 新的查新指令;\n#e.g\nalter view v_student_info as select t1.s_name, t2.c_name from t_45 tl \nleft join t_46 t2 using(c_id);\n\ncreate or replace v_student_info as select tl.s_name, t2.c_name from t_45 tl \nleft join t_46 t2 using(c_id);\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("删除视图")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("drop view 视图名;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("h2",{attrs:{id:"数据操作"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据操作"}},[s._v("#")]),s._v(" 数据操作")]),s._v(" "),a("blockquote",[a("p",[s._v("概念 视图数据操作:直接对视图进行写操作(增删改)然后实现基表数据的变化")])]),s._v(" "),a("p",[s._v("视图所有的数据操作都是最终对基表的数据操作")]),s._v(" "),a("ul",[a("li",[s._v("视图操作条件\n"),a("ul",[a("li",[s._v("多基表视图:不允许操作(增删改都不行)")]),s._v(" "),a("li",[s._v("单基表视图:允许增删改\n"),a("ul",[a("li",[s._v("新增条件:视图的字段必须包含基表中所有不允许为空的字段")])])]),s._v(" "),a("li",[s._v("with check option:操作检查规则")]),s._v(" "),a("li",[s._v("默认不需要这个规则(创建视图时指定):视图操作只要满足前面上述条件即可")]),s._v(" "),a("li",[s._v("增加此规则:视图的数据操作后,必须要保证该视图还能把通过视图操作的数据査岀来(否则失败)")])])])]),s._v(" "),a("h2",{attrs:{id:"视图算法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#视图算法"}},[s._v("#")]),s._v(" 视图算法")]),s._v(" "),a("p",[s._v("视图算法:指视图在执行过程中对于内部的 select指令的处理方式")]),s._v(" "),a("ul",[a("li",[s._v("视图算法在创建视图时指定")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create ALGORITHM = 算法 view 视图名字 as select 指令;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ul",[a("li",[s._v("视图算法一共有三种\n"),a("ul",[a("li",[a("code",[s._v("undefined")]),s._v(" : 默认的,未定义算法,即系统自动选择算法")]),s._v(" "),a("li",[a("code",[s._v("merge")]),s._v(" : 合并算法,就是将视图外部査询语句跟视图内部 select语句合并后执行,效率高(系统优先选择)")]),s._v(" "),a("li",[a("code",[s._v("temptable")]),s._v(" : 临时表算法,即系统将视图的 select语句查岀来先得岀一张临时表,然后外部再查询( temptable 算法视图不允许写操作)")])])])]),s._v(" "),a("ol",[a("li",[s._v("创建三种不同算法视图")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("create algorithm= undefined view v_student_4 as select from t_42 order by age desc;\ncreate algorithm= merge view v_student_5 as select from t_42 order by age desc;\ncreate algorithm= temptable view v_student_6 as select from t_42 order by age desc;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br")])]),a("ol",{attrs:{start:"2"}},[a("li",[s._v("使用视图:为了体现算法效果,给视图增加分组效果")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("\nselect count(*), any_value(name), any_value(age), class_name, max(age) \nfrom v_student_4 group by class_name;\n\nselect count(*), any_value(name), any_value(age), class_name, max(age) \nfrom v_student_5 group by class-name;\n\nselect count(*), any_value(name), any_value(age), class_name, max(age) \nfrom v_student_6 group by class_name;\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br")])]),a("ol",{attrs:{start:"3"}},[a("li",[s._v("临时表算法的视图不能进行数据插入操作")])]),s._v(" "),a("div",{staticClass:"language-mysql line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("insert into v_student_6 values(nu11,'冥加','男',100,'神妖1班');#错误:不可插入\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("ol",[a("li",[s._v("视图算法是用来结合外部外的查询指令的优化思路,主要的优化方式有两种\n"),a("ul",[a("li",[s._v("merge:合并算法,将视图的 select与外部 select合并成一条,然后执行一次(效率高)")]),s._v(" "),a("li",[s._v("temptable:临时表算法,视图的指令单独执行得到个二维表,然后外部 select再执行(安全)")]),s._v(" "),a("li",[s._v("undefined:未定义算法是种系统自动选择的算法,系统偏冋于选择 merge算法")])])]),s._v(" "),a("li",[s._v("一般在设计视图的时候要考虑到视图算法的可行性,通常视图中如果出现了 order by 排序的话,就要考虑使用\ntemptable算法\n"),a("ul",[a("li",[s._v("只要 merge以后,不会导致数据因为子句的先后顺序而混乱( order by与 group by的顺序混乱容易出问题)")])])])])])}),[],!1,null,null,null);e.default=t.exports}}]);