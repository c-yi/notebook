(window.webpackJsonp=window.webpackJsonp||[]).push([[172],{563:function(s,n,a){"use strict";a.r(n);var t=a(23),e=Object(t.a)({},(function(){var s=this,n=s.$createElement,a=s._self._c||n;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h1",{attrs:{id:"nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx"}},[s._v("#")]),s._v(" nginx")]),s._v(" "),a("p",[s._v("172.17.0.2")]),s._v(" "),a("h2",{attrs:{id:"概念"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#概念"}},[s._v("#")]),s._v(" 概念")]),s._v(" "),a("h3",{attrs:{id:"什么是nginx"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#什么是nginx"}},[s._v("#")]),s._v(" 什么是nginx")]),s._v(" "),a("p",[s._v("是一个高性能的 HTTP 和 反向代理服务器, 特点是占用少,并发能力强 ,理想状态下,单个nginx服务可支持5万个并发数")]),s._v(" "),a("h3",{attrs:{id:"反向代理"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反向代理"}},[s._v("#")]),s._v(" 反向代理")]),s._v(" "),a("blockquote",[a("p",[s._v("正向代理 : 在客户端 配置代理服务器, 通过代理服务器进行互联网访问")]),s._v(" "),a("p",[s._v("反向代理 : 只对用户暴露代理服务器,隐藏资源服务器,通过代理服务器获取资源")])]),s._v(" "),a("h3",{attrs:{id:"负载均衡"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#负载均衡"}},[s._v("#")]),s._v(" 负载均衡")]),s._v(" "),a("h3",{attrs:{id:"动静分离"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#动静分离"}},[s._v("#")]),s._v(" 动静分离")]),s._v(" "),a("h3",{attrs:{id:"高可用"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#高可用"}},[s._v("#")]),s._v(" 高可用")]),s._v(" "),a("h2",{attrs:{id:"安装"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装"}},[s._v("#")]),s._v(" 安装")]),s._v(" "),a("p",[s._v("依赖安装")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 编译依赖gcc环境，如果没有gcc环境，")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" gcc-c++\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx的http模块使用pcre来解析正则表达式，所以需要在linux上安装pcre库。")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y pcre pcre-devel\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx使用zlib对http包的内容进行gzip，所以需要在linux上安装zlib库。")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y zlib zlib-devel\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# OpenSSL 是一个强大的安全套接字层密码库，囊括主要的密码算法、常用的密钥和证书封装管理功能及SSL协议，")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 并提供丰富的应用程序供测试或其它目的使用。")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# nginx不仅支持http协议，还支持https（即在ssl协议上传输http），所以需要在linux安装openssl库。")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" -y openssl openssl-devel\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可以合并安装")]),s._v("\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" pcre pcre-devel zlib zlib-devel gcc-c++ libtool openssl openssl-devel\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装 nginx")]),s._v("\n\nyum -y "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("wget")]),s._v("  http://nginx.org/download/nginx-1.17.6.tar.gz\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解压")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" -zxvf /usr/local/tarzip/nginx-1.17.6.tar.gz -C /usr/local/software/nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查包的完整性 编译 安装")]),s._v("\n./configure "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("make")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 最后在 下面的目录中会出现一个 nginx 的可执行文件")]),s._v("\n/usr/local/nginx/sbin\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br")])]),a("blockquote",[a("p",[s._v("启动nginx 并 查看进程")])]),s._v(" "),a("p",[a("img",{attrs:{src:"C:%5CUsers%5C%E7%A8%8B%E7%87%9A%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1581405773978.png",alt:"1581405773978"}})]),s._v(" "),a("h2",{attrs:{id:"nginx配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置"}},[s._v("#")]),s._v(" nginx配置")]),s._v(" "),a("blockquote",[a("p",[s._v("/usr/local/nginx/conf/nginx.conf  配置文件")])]),s._v(" "),a("h3",{attrs:{id:"防火墙"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#防火墙"}},[s._v("#")]),s._v(" 防火墙")]),s._v(" "),a("div",{staticClass:"language-shell line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-shell"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装防火墙")]),s._v("\nyum "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" firewalld\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看开放的端口")]),s._v("\nfirewall-cmd --list-all\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开放新端口")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" firewall-cmd --add-port"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp --permanent\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启防火墙")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" firewall-cmd --reload\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("h3",{attrs:{id:"nginx-常用命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-常用命令"}},[s._v("#")]),s._v(" nginx 常用命令")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用 nginx 命令需要切换到 /usr/local/nginx/sbin 目录下")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 版本号")]),s._v("\n./nginx -v\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止")]),s._v("\n./nginx -s stop 强制退出\n./nginx -s quit 普通退出 \n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动")]),s._v("\n./nginx\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重载(热部署) 用于重新加载配置文件 nginx.conf")]),s._v("\n./nginx -s reload\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("h2",{attrs:{id:"nginx-配置文件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx-配置文件"}},[s._v("#")]),s._v(" nginx 配置文件")]),s._v(" "),a("p",[s._v("nginx配置文件组成")]),s._v(" "),a("h3",{attrs:{id:"全局块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局块"}},[s._v("#")]),s._v(" 全局块")]),s._v(" "),a("p",[s._v("从配置文件开始到 events块之间的内容,主要会设置一些影响 ngInx服务器整体运行的配置指令\n比如 worker__ processes1; worker_processes值越大,可以支持的并发处理量也越多")]),s._v(" "),a("h3",{attrs:{id:"events-块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#events-块"}},[s._v("#")]),s._v(" events 块")]),s._v(" "),a("p",[s._v("events块涉及的指令主要影响 Nginx服务器与用户的网络连接\n比如 worker connections 1024;支持的最大连接数")]),s._v(" "),a("h3",{attrs:{id:"http-块"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#http-块"}},[s._v("#")]),s._v(" http 块")]),s._v(" "),a("p",[s._v("Nginx服器配置中改动最频繁的部分,http块可以括http全局块, server块")]),s._v(" "),a("h3",{attrs:{id:"反向代理-2"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#反向代理-2"}},[s._v("#")]),s._v(" 反向代理")]),s._v(" "),a("p",[a("img",{attrs:{src:"C:%5CUsers%5C%E7%A8%8B%E7%87%9A%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1581432482828.png",alt:"1581432482828"}})]),s._v(" "),a("p",[a("img",{attrs:{src:"C:%5CUsers%5C%E7%A8%8B%E7%87%9A%5CAppData%5CRoaming%5CTypora%5Ctypora-user-images%5C1581432683726.png",alt:"1581432683726"}})]),s._v(" "),a("div",{staticClass:"language-markdown line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-markdown"}},[a("code",[s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("p",[a("code",[s._v("=")]),s._v("\t用于不含正则表达式的uri前,要求请求字符串与uri严格匹配,如果匹配成功,就停止继续向下搜索并立即处理该请求。\n"),a("code",[s._v("~")]),s._v("\t用于表示uri包含正则表达式,并且区分大小写。")]),s._v(" "),a("p",[a("code",[s._v("~*")]),s._v("\t用于表示uri包含正则表达式,并且不区分大小写。")]),s._v(" "),a("p",[a("code",[s._v("^~")]),s._v("\t用于不含正则表达式的uri前,要求 Nginx服务器找到标识uri和请求字符串匹配度最高的location后,立即使用此location处理请求,而不再使用location块中的正则uri和请求字符串做匹配。")]),s._v(" "),a("p",[s._v("注意:如果uri包含正则表达式,则必须要有\t\t"),a("code",[s._v("~")]),s._v("\t或者\t"),a("code",[s._v("~*")]),s._v("\t标识")]),s._v(" "),a("hr"),s._v(" "),a("p",[s._v("日志文件位置：/var/log/nginx\n配置文件位置：/etc/nginx\n资源存放位置：/usr/share/nginx/html")]),s._v(" "),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker stop `docker ps -aq --filter name=nginx` \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run --name mynginx -d -p 8000:80 \\\n  -v $PWD/log:/var/log/nginx \\\n  -v $PWD/config:/etc/nginx \\\n  -v $PWD/html:/usr/share/nginx/html \\\n  nginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run --name nginx_erp_test -d -p 80:80\n-v /www/html/attachment:/www/html/attachment \n-v /data/nginx/html:/usr/share/nginx/html \n-v /data/nginx/conf/nginx.conf:/etc/nginx/nginx.conf  \n-v /data/nginx/logs:/var/log/nginx \n-v /data/nginx/conf.d:/etc/nginx/conf.d\nnginx\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])]),a("div",{staticClass:"language- line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-text"}},[a("code",[s._v("docker run -d \\ # -d 后台运行\n-v /data/mysql/data:/var/lib/mysql \\ #挂载本地data目录到 容器中的位置 mysql\n-p 3306:3306 \\  #指定容器端口映射到本机端口3306\n-e MARIADB_USRE=root \\ #设置环境变量用户名\n-e MARIADB_PASS=123456 \\ #设置环境变量密码\n--name mymariadb \\ #指定容器名字为mymariadb\nmariadb \n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br")])])])}),[],!1,null,null,null);n.default=e.exports}}]);