(window.webpackJsonp=window.webpackJsonp||[]).push([[46],{414:function(e,s,t){"use strict";t.r(s);var n=t(23),a=Object(n.a)({},(function(){var e=this,s=e.$createElement,t=e._self._c||s;return t("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[t("h1",{attrs:{id:"外键"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外键"}},[e._v("#")]),e._v(" 外键")]),e._v(" "),t("p",[e._v("外键: foreign key,表中"),t("strong",[e._v("指向外部表主键的字段")]),e._v("定义成外键")]),e._v(" "),t("ul",[t("li",[e._v("外键必须要通过语法指定才能称之为外键\n"),t("code",[e._v("[ constraint 外键名] foreign key(当前表字段名) references 外部表(主键字段)")])]),e._v(" "),t("li",[e._v("外键构成条件\n"),t("ul",[t("li",[e._v("外键字段必须与对应表的主键字段类型一致")]),e._v(" "),t("li",[e._v("外键字段本身要求是一个索引(创建外键会自动生成一个索引)")])])]),e._v(" "),t("li",[e._v("一张表可以有多个外键,但是一个字段只能产生一个外键")])]),e._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("# 1. 创建专业表和学生表,学生表中的专业id指向专业表id\ncreate table t_47(\n\tid int primary key auto_increment,\n\tname varchar(50) not null unique\n)charset utf8;\n\ncreate table t_48(\n\tid int primary key auto_increment,\n\tname varchar (50) not null,\n\tc_id int comment'指向t_47表中的id主键',\n\tconstraint `c_id` foreign key(c_id) references t_47(id)\n    # 外键可以不指定名称系统会自动生成 上下两条语句是等价的\n    foreign key(c_id) references t_47(id)\n)charset utf8;\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br"),t("span",{staticClass:"line-number"},[e._v("2")]),t("br"),t("span",{staticClass:"line-number"},[e._v("3")]),t("br"),t("span",{staticClass:"line-number"},[e._v("4")]),t("br"),t("span",{staticClass:"line-number"},[e._v("5")]),t("br"),t("span",{staticClass:"line-number"},[e._v("6")]),t("br"),t("span",{staticClass:"line-number"},[e._v("7")]),t("br"),t("span",{staticClass:"line-number"},[e._v("8")]),t("br"),t("span",{staticClass:"line-number"},[e._v("9")]),t("br"),t("span",{staticClass:"line-number"},[e._v("10")]),t("br"),t("span",{staticClass:"line-number"},[e._v("11")]),t("br"),t("span",{staticClass:"line-number"},[e._v("12")]),t("br"),t("span",{staticClass:"line-number"},[e._v("13")]),t("br"),t("span",{staticClass:"line-number"},[e._v("14")]),t("br")])]),t("h3",{attrs:{id:"外键约束"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外键约束"}},[e._v("#")]),e._v(" 外键约束")]),e._v(" "),t("p",[e._v("外键约束:当表建立外键关系后,外键就会对"),t("strong",[e._v("主表")]),e._v("(外键指向的表)和"),t("strong",[e._v("子表")]),e._v("(外键所在的表)里的数据产生约束效果")]),e._v(" "),t("ul",[t("li",[e._v("外键约束的是写操作(默认操作)\n"),t("ul",[t("li",[e._v("新增:子表插入的数据对应的外键必须在主表存在")]),e._v(" "),t("li",[e._v("修改:主表的记录如果在子表存在,那么主表的主键不能修改(主键不能修改)")]),e._v(" "),t("li",[e._v("删除:主表的记录如果在子表存在,那么主表的主键不能删除")])])]),e._v(" "),t("li",[e._v("外键约束控制:外键可以在定义时控制外键的约束作用\n"),t("ul",[t("li",[e._v("控制类型\n"),t("ul",[t("li",[e._v("on update : 父表更新时子表的表现")]),e._v(" "),t("li",[e._v("on delete : 父表删除时子表的表现")])])]),e._v(" "),t("li",[e._v("控制方式")]),e._v(" "),t("li",[e._v("cascade:级联操作,父表操作后子表跟随操作")]),e._v(" "),t("li",[e._v("set null:置空操作,父表操作后,子表关联的外键字段置空")]),e._v(" "),t("li",[e._v("restrict :严格模式,不允许父表操作(默认的)")]),e._v(" "),t("li",[e._v("no action : 父表随意操作,子表不管")])])])]),e._v(" "),t("blockquote",[t("p",[t("strong",[e._v("小结")])])]),e._v(" "),t("p",[e._v("1、外键约束对子表和父表都有约束")]),e._v(" "),t("ul",[t("li",[e._v("子表约束:子表不能插入父表不存在的外键")]),e._v(" "),t("li",[e._v("父表约束\n"),t("ul",[t("li",[e._v("更新约束(默认不允许)")]),e._v(" "),t("li",[e._v("删除约束(默认不允许)")])])]),e._v(" "),t("li",[e._v("一般约束\n"),t("ul",[t("li",[e._v("级联更新")]),e._v(" "),t("li",[e._v("删除置空")])])])]),e._v(" "),t("p",[e._v("2、外键约束增强了数据的安全性和可靠性,但是会增加程序对于数据的不可控性,所以是实际开发中一般会通过\n程序逻辑控制来保证数据的完整性和安全性,外键使用较少")]),e._v(" "),t("h3",{attrs:{id:"外键管理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#外键管理"}},[e._v("#")]),e._v(" 外键管理")]),e._v(" "),t("blockquote",[t("p",[e._v("概念  外键管理:在表创建后期维护外键")])]),e._v(" "),t("ul",[t("li",[e._v("新增外键")])]),e._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("alter table 表名 add [ constraint`外建名] foreign key(外键字段) references 表名(主键) [on 外键约束]\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ul",[t("li",[e._v("删除外键")])]),e._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("alter table表名 drop foreign key 外键名;\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("ul",[t("li",[t("p",[e._v("更新外键:先删除后新增")])]),e._v(" "),t("li",[t("p",[e._v("删除外键")]),e._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("alter table t_51 drop foreign key t_51ibfk_1;#系统生成的外键\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])])]),e._v(" "),t("li",[t("p",[e._v("追加外键")]),e._v(" "),t("div",{staticClass:"language-mysql line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[e._v("alter table t_51 add constraint `t_51_50` foreign key (c_id) references t_50(id)\n")])]),e._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[e._v("1")]),t("br")])]),t("p",[e._v("注意:追加外键需要保证外键字段里的值要么为Null,要么在父表中都能找到")])])])])}),[],!1,null,null,null);s.default=a.exports}}]);